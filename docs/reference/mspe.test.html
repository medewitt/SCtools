<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Function to compute the post/pre treatment MSPE ratio for the 
    treated unit and placebos — mspe.test • SCtools</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Function to compute the post/pre treatment MSPE ratio for the 
    treated unit and placebos — mspe.test" />

<meta property="og:description" content="Computes the post/pre treatement mean square prediction error 
   ratio for a treated unit in a synthetic control analysis and all placebos 
   produced with generate.placebos. Returns a matrix with 
   ratios and a p-value of how extreme the treated unit's ratio is in 
   comparison with that of placebos. Equivalent to a significance testing 
   of a synthetic controls result." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SCtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/replicating-basque.html">Replicating the Basque Study</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Function to compute the post/pre treatment MSPE ratio for the 
    treated unit and placebos</h1>
    
    <div class="hidden name"><code>mspe.test.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Computes the post/pre treatement mean square prediction error 
   ratio for a treated unit in a synthetic control analysis and all placebos 
   produced with <code><a href='generate.placebos.html'>generate.placebos</a></code>. Returns a matrix with 
   ratios and a p-value of how extreme the treated unit's ratio is in 
   comparison with that of placebos. Equivalent to a significance testing 
   of a synthetic controls result.</p>
    
    </div>

    <pre class="usage"><span class='fu'>mspe.test</span>(<span class='no'>tdf</span>, <span class='kw'>discard.extreme</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>mspe.limit</span> <span class='kw'>=</span> <span class='fl'>20</span>)

<span class='fu'>mspe_test</span>(<span class='no'>tdf</span>, <span class='kw'>discard.extreme</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>mspe.limit</span> <span class='kw'>=</span> <span class='fl'>20</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>tdf</th>
      <td><p>An object constructed by <code><a href='generate.placebos.html'>generate.placebos</a></code></p></td>
    </tr>
    <tr>
      <th>discard.extreme</th>
      <td><p>Logical. Whether or not placebos with high 
pre-treatement MSPE should be excluded from the count and significance 
testing.</p></td>
    </tr>
    <tr>
      <th>mspe.limit</th>
      <td><p>Numerical. Used if <code>discard.extreme</code> is <code>TRUE</code>. 
It indicates how many times the pretreatment MSPE of a placebo should be 
higher than that of the treated unit to be considered extreme and 
discarded. Default is <code>20</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    
<dl class='dl-horizontal'>
   <dt>p.val</dt><dd><p>The p-value of the treated unit post/pre MSPE ratio. 
   It is the proportion of units (placebos and treated) that have a ratio 
   equal or higher that of the treated unit</p></dd>
   <dt>test</dt><dd><p>Dataframe with two columns. The first is the post/pre MSPE 
   ratio for each unit. The second indicates unit names</p></dd>
</dl>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Post/pre-treatement mean square prediction error ratio is the 
   difference between the observed outcome of a unit and its synthetic 
   control, before and after treatement. A higher ratio means a small 
   pre-treatment prediction error (a good synthetic control), and a 
   high post-treatment MSPE, meaning a large difference between the unit 
   and its synthetic control after the intervention. 
   By calculating this ratio for all placebos, the test can be interpreted 
   as looking at how likely the result obtained for a single treated case 
   with a synthetic control analysis could have occurred by chance given 
   no treatement. For more detailed description, see Abadie, Diamond, 
   and Hainmueller (2011, 2014).</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='generate.placebos.html'>generate.placebos</a></code>, <code><a href='mspe.plot.html'>mspe.plot</a></code>, 
   <code><a href='https://www.rdocumentation.org/packages/Synth/topics/synth'>synth</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## First prepare the required objects</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>Synth</span>)
<span class='co'># Load simulated data from Synth</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>synth.data</span>)

<span class='co'># Execute dataprep to produce the necessary matrices for synth</span>
<span class='no'>dataprep.out</span><span class='kw'>&lt;-</span>
  <span class='fu'><a href='https://www.rdocumentation.org/packages/Synth/topics/dataprep'>dataprep</a></span>(
    <span class='kw'>foo</span> <span class='kw'>=</span> <span class='no'>synth.data</span>,
    <span class='kw'>predictors</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"X1"</span>, <span class='st'>"X2"</span>, <span class='st'>"X3"</span>),
    <span class='kw'>predictors.op</span> <span class='kw'>=</span> <span class='st'>"mean"</span>,
    <span class='kw'>dependent</span> <span class='kw'>=</span> <span class='st'>"Y"</span>,
    <span class='kw'>unit.variable</span> <span class='kw'>=</span> <span class='st'>"unit.num"</span>,
    <span class='kw'>time.variable</span> <span class='kw'>=</span> <span class='st'>"year"</span>,
    <span class='kw'>special.predictors</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(
      <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='st'>"Y"</span>, <span class='fl'>1991</span>, <span class='st'>"mean"</span>),
      <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='st'>"Y"</span>, <span class='fl'>1985</span>, <span class='st'>"mean"</span>),
      <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='st'>"Y"</span>, <span class='fl'>1980</span>, <span class='st'>"mean"</span>)
    ),
    <span class='kw'>treatment.identifier</span> <span class='kw'>=</span> <span class='fl'>7</span>,
    <span class='kw'>controls.identifier</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>29</span>, <span class='fl'>2</span>, <span class='fl'>13</span>, <span class='fl'>17</span>, <span class='fl'>32</span>, <span class='fl'>38</span>),
    <span class='kw'>time.predictors.prior</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1984</span>:<span class='fl'>1989</span>),
    <span class='kw'>time.optimize.ssr</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1984</span>:<span class='fl'>1990</span>),
    <span class='kw'>unit.names.variable</span> <span class='kw'>=</span> <span class='st'>"name"</span>,
    <span class='kw'>time.plot</span> <span class='kw'>=</span> <span class='fl'>1984</span>:<span class='fl'>1996</span>
  )

<span class='co'># run the synth command to create the synthetic control</span>
<span class='no'>synth.out</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/Synth/topics/synth'>synth</a></span>(<span class='no'>dataprep.out</span>)</div><div class='output co'>#&gt; 
#&gt; X1, X0, Z1, Z0 all come directly from dataprep object.
#&gt; 
#&gt; 
#&gt; **************** 
#&gt;  searching for synthetic control unit  
#&gt;  
#&gt; 
#&gt; **************** 
#&gt; **************** 
#&gt; **************** 
#&gt; 
#&gt; MSPE (LOSS V): 4.714688 
#&gt; 
#&gt; solution.v:
#&gt;  0.00490263 0.003884407 0.1972011 0.2707289 0.0007091301 0.5225738 
#&gt; 
#&gt; solution.w:
#&gt;  0.0001407318 0.004851527 0.1697786 0.2173031 0.6079231 2.9419e-06 
#&gt; </div><div class='input'>
<span class='co'>## run the generate.placebos command to reassign treatment status</span>
<span class='co'>## to each unit listed as control, one at a time, and generate their</span>
<span class='co'>## synthetic versions. </span>
<span class='no'>tdf</span><span class='kw'>&lt;-</span><span class='fu'><a href='generate.placebos.html'>generate.placebos</a></span>(<span class='no'>dataprep.out</span>, <span class='no'>synth.out</span>)</div><div class='output co'>#&gt; 
#&gt; X1, X0, Z1, Z0 all come directly from dataprep object.
#&gt; 
#&gt; 
#&gt; **************** 
#&gt;  searching for synthetic control unit  
#&gt;  
#&gt; 
#&gt; **************** 
#&gt; **************** 
#&gt; **************** 
#&gt; 
#&gt; MSPE (LOSS V): 1.919039 
#&gt; 
#&gt; solution.v:
#&gt;  4.26e-08 0.3314532 2.50708e-05 0.273401 0.1669915 0.2281292 
#&gt; 
#&gt; solution.w:
#&gt;  0.05832822 0.5057193 0.001459438 0.432908 0.00158504 
#&gt; 
#&gt; 
#&gt; X1, X0, Z1, Z0 all come directly from dataprep object.
#&gt; 
#&gt; 
#&gt; **************** 
#&gt;  searching for synthetic control unit  
#&gt;  
#&gt; 
#&gt; **************** 
#&gt; **************** 
#&gt; **************** 
#&gt; 
#&gt; MSPE (LOSS V): 2656.617 
#&gt; 
#&gt; solution.v:
#&gt;  0.05378089 0.03614492 0.1033622 0.3066906 0.1146891 0.3853323 
#&gt; 
#&gt; solution.w:
#&gt;  5.5359e-06 6.589e-07 0.2873189 0.7126745 3.908e-07 
#&gt; 
#&gt; 
#&gt; X1, X0, Z1, Z0 all come directly from dataprep object.
#&gt; 
#&gt; 
#&gt; **************** 
#&gt;  searching for synthetic control unit  
#&gt;  
#&gt; 
#&gt; **************** 
#&gt; **************** 
#&gt; **************** 
#&gt; 
#&gt; MSPE (LOSS V): 4.417489 
#&gt; 
#&gt; solution.v:
#&gt;  4.16708e-05 2.2374e-06 0.0002522976 0.312786 0.3920212 0.2948966 
#&gt; 
#&gt; solution.w:
#&gt;  0.2640319 0.05262123 0.000396628 0.001012998 0.6819372 
#&gt; 
#&gt; 
#&gt; X1, X0, Z1, Z0 all come directly from dataprep object.
#&gt; 
#&gt; 
#&gt; **************** 
#&gt;  searching for synthetic control unit  
#&gt;  
#&gt; 
#&gt; **************** 
#&gt; **************** 
#&gt; **************** 
#&gt; 
#&gt; MSPE (LOSS V): 93.9186 
#&gt; 
#&gt; solution.v:
#&gt;  0.3067778 0.01604218 0.01562176 0.006057079 0.5752435 0.08025769 
#&gt; 
#&gt; solution.w:
#&gt;  1.7048e-06 0.2398606 0.7601323 2.138e-06 3.2977e-06 
#&gt; 
#&gt; 
#&gt; X1, X0, Z1, Z0 all come directly from dataprep object.
#&gt; 
#&gt; 
#&gt; **************** 
#&gt;  searching for synthetic control unit  
#&gt;  
#&gt; 
#&gt; **************** 
#&gt; **************** 
#&gt; **************** 
#&gt; 
#&gt; MSPE (LOSS V): 6.180212 
#&gt; 
#&gt; solution.v:
#&gt;  0.0002384139 0.02854083 3.08429e-05 0.8305712 0.1359355 0.00468322 
#&gt; 
#&gt; solution.w:
#&gt;  0.5634249 0.1701299 3.351e-07 0.0002552697 0.2661896 
#&gt; 
#&gt; 
#&gt; X1, X0, Z1, Z0 all come directly from dataprep object.
#&gt; 
#&gt; 
#&gt; **************** 
#&gt;  searching for synthetic control unit  
#&gt;  
#&gt; 
#&gt; **************** 
#&gt; **************** 
#&gt; **************** 
#&gt; 
#&gt; MSPE (LOSS V): 61.19353 
#&gt; 
#&gt; solution.v:
#&gt;  0.01419207 6.4e-08 0.0178097 0.187153 0.5235156 0.2573296 
#&gt; 
#&gt; solution.w:
#&gt;  5.17837e-05 1.4881e-06 0.9998792 4.41379e-05 2.33603e-05 
#&gt; </div><div class='input'>
<span class='co'>## Test how extreme was the observed treatment effect given the placebos:</span>
<span class='no'>ratio</span> <span class='kw'>&lt;-</span> <span class='fu'>mspe.test</span>(<span class='no'>tdf</span>)
<span class='no'>ratio</span>$<span class='no'>p.val</span></div><div class='output co'>#&gt; [1] 0.1428571</div><div class='input'>
<span class='fu'><a href='mspe.plot.html'>mspe.plot</a></span>(<span class='no'>tdf</span>,<span class='no'>discard</span>, <span class='kw'>discard.extreme</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='mspe.test-1.png' alt='' width='700' height='433' /></div><div class='input'>   
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Bruno Castanho Silva, Michael DeWitt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

