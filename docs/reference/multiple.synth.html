<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Function to Apply Synthetic Controls to Multiple Treated Units — multiple.synth • SCtools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Function to Apply Synthetic Controls to Multiple Treated Units — multiple.synth" />
<meta property="og:description" content="Generates one synthetic control for each treated unit and calculates 
   the difference between the treated and the synthetic control for each. 
   Returns a vector with outcome values for the synthetic controls, 
   a plot of average treatment effects, and if required generates placebos 
   out of the donor pool to be used in conjunction with plac.dist. 
   All arguments are the same used for dataprep in the Synth
   package, except for treated.units, treatment.time, and 
   generate.placebos." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SCtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/case-study.html">SCM Case Study on Alcohol Consumption</a>
    </li>
    <li>
      <a href="../articles/replicating-basque.html">Replicating the Basque Study</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Function to Apply Synthetic Controls to Multiple Treated Units</h1>
    
    <div class="hidden name"><code>multiple.synth.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates one synthetic control for each treated unit and calculates 
   the difference between the treated and the synthetic control for each. 
   Returns a vector with outcome values for the synthetic controls, 
   a plot of average treatment effects, and if required generates placebos 
   out of the donor pool to be used in conjunction with <code><a href='plac.dist.html'>plac.dist</a></code>. 
   All arguments are the same used for <code><a href='https://rdrr.io/pkg/Synth/man/dataprep.html'>dataprep</a></code> in the <code><a href='https://rdrr.io/pkg/Synth/man/synth.html'>Synth</a></code>
   package, except for <code>treated.units</code>, <code>treatment.time</code>, and 
   <code><a href='generate.placebos.html'>generate.placebos</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>multiple.synth</span>(<span class='no'>foo</span>, <span class='no'>predictors</span>, <span class='no'>predictors.op</span>, <span class='no'>dependent</span>, <span class='no'>unit.variable</span>,
  <span class='no'>time.variable</span>, <span class='no'>special.predictors</span>, <span class='no'>treated.units</span>, <span class='no'>control.units</span>,
  <span class='no'>time.predictors.prior</span>, <span class='no'>time.optimize.ssr</span>, <span class='no'>unit.names.variable</span>, <span class='no'>time.plot</span>,
  <span class='no'>treatment.time</span>, <span class='kw'>gen.placebos</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>strategy</span> <span class='kw'>=</span> <span class='st'>"sequential"</span>,
  <span class='kw'>Sigf.ipop</span> <span class='kw'>=</span> <span class='fl'>5</span>)

<span class='fu'>multiple_synth</span>(<span class='no'>foo</span>, <span class='no'>predictors</span>, <span class='no'>predictors.op</span>, <span class='no'>dependent</span>, <span class='no'>unit.variable</span>,
  <span class='no'>time.variable</span>, <span class='no'>special.predictors</span>, <span class='no'>treated.units</span>, <span class='no'>control.units</span>,
  <span class='no'>time.predictors.prior</span>, <span class='no'>time.optimize.ssr</span>, <span class='no'>unit.names.variable</span>, <span class='no'>time.plot</span>,
  <span class='no'>treatment.time</span>, <span class='kw'>gen.placebos</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>strategy</span> <span class='kw'>=</span> <span class='st'>"sequential"</span>,
  <span class='kw'>Sigf.ipop</span> <span class='kw'>=</span> <span class='fl'>5</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>foo</th>
      <td><p>Dataframe with the panel data.</p></td>
    </tr>
    <tr>
      <th>predictors</th>
      <td><p>Vector of column numbers or column-name character strings 
that identifies the predictors' columns. All predictors have to be numeric.</p></td>
    </tr>
    <tr>
      <th>predictors.op</th>
      <td><p>A character string identifying the method (operator) 
to be used on the predictors. Default is <code>mean</code>.</p></td>
    </tr>
    <tr>
      <th>dependent</th>
      <td><p>The column number or a string with the column name that 
corresponds to the dependent variable.</p></td>
    </tr>
    <tr>
      <th>unit.variable</th>
      <td><p>The column number or a string with the column name 
that identifies unit numbers. The variable must be numeric.</p></td>
    </tr>
    <tr>
      <th>time.variable</th>
      <td><p>The column number or a string with the column name 
that identifies the period (time) data. The variable must be numeric.</p></td>
    </tr>
    <tr>
      <th>special.predictors</th>
      <td><p>A list object identifying additional predictors and 
their pre-treatment years and operators.</p></td>
    </tr>
    <tr>
      <th>treated.units</th>
      <td><p>A vector identifying the <code>unit.variable</code> numbers of 
the treated units.</p></td>
    </tr>
    <tr>
      <th>control.units</th>
      <td><p>A vector identifying the <code>unit.variable</code> numbers of 
the control units.</p></td>
    </tr>
    <tr>
      <th>time.predictors.prior</th>
      <td><p>A numeric vector identifying the pretreatment 
periods over which the values for the outcome predictors should be averaged.</p></td>
    </tr>
    <tr>
      <th>time.optimize.ssr</th>
      <td><p>A numeric vector identifying the periods of the 
dependent variable over which the loss function should be minimized 
between each treated unit and its synthetic control.</p></td>
    </tr>
    <tr>
      <th>unit.names.variable</th>
      <td><p>The column number or string with column name 
identifying the variable with units' names. The variable must be a character.</p></td>
    </tr>
    <tr>
      <th>time.plot</th>
      <td><p>A vector identifying the periods over which results are 
to be plotted with <code>path.plot</code></p></td>
    </tr>
    <tr>
      <th>treatment.time</th>
      <td><p>A numeric value with the value in <code>time.variable</code>
that marks the intervention.</p></td>
    </tr>
    <tr>
      <th>gen.placebos</th>
      <td><p>Logical. Whether a placebo (a synthetic control) 
for each unit in the donor pool should be constructed. Will increase 
computation time.</p></td>
    </tr>
    <tr>
      <th>strategy</th>
      <td><p>The processing method you wish to use 
"sequential" or "multiprocess". Use "multiprocess" to parallelize operations
 and reduce computing time. Default is <code>sequential</code>.</p></td>
    </tr>
    <tr>
      <th>Sigf.ipop</th>
      <td><p>The Precision setting for the ipop optimization routine. 
Default of 5.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Data frame. Each column contains the outcome values for every 
time-point for one unit or its synthetic control. The last column contains 
the time-points.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function runs <code><a href='https://rdrr.io/pkg/Synth/man/dataprep.html'>dataprep</a></code> and <code><a href='https://rdrr.io/pkg/Synth/man/synth.html'>synth</a></code> 
   for each unit identified in <code>treated.units</code>. It saves the vector with 
   predicted values for each synthetic control, to be used in estimating 
   average treatment effects in applications of Synthetic Controls for 
   multiple treated units.</p>   
<p>For further details on the arguments, see the documentation of 
   <code><a href='https://rdrr.io/pkg/Synth/man/synth.html'>Synth</a></code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Using the toy data from 'Synth':</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>Synth</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>synth.data</span>)
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>42</span>)

<span class='no'>multi</span> <span class='kw'>&lt;-</span> <span class='fu'>multiple.synth</span>(<span class='kw'>foo</span> <span class='kw'>=</span> <span class='no'>synth.data</span>,
                       <span class='kw'>predictors</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"X1"</span>, <span class='st'>"X2"</span>, <span class='st'>"X3"</span>),
                       <span class='kw'>predictors.op</span> <span class='kw'>=</span> <span class='st'>"mean"</span>,
                       <span class='kw'>dependent</span> <span class='kw'>=</span> <span class='st'>"Y"</span>,
                       <span class='kw'>unit.variable</span> <span class='kw'>=</span> <span class='st'>"unit.num"</span>,
                       <span class='kw'>time.variable</span> <span class='kw'>=</span> <span class='st'>"year"</span>,
                       <span class='kw'>treatment.time</span> <span class='kw'>=</span> <span class='fl'>1990</span>,
                       <span class='kw'>special.predictors</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
                         <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"Y"</span>, <span class='fl'>1991</span>, <span class='st'>"mean"</span>),
                         <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"Y"</span>, <span class='fl'>1985</span>, <span class='st'>"mean"</span>),
                         <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"Y"</span>, <span class='fl'>1980</span>, <span class='st'>"mean"</span>)
                       ),
                       <span class='kw'>treated.units</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>7</span>),
                       <span class='kw'>control.units</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>29</span>, <span class='fl'>13</span>, <span class='fl'>17</span>, <span class='fl'>32</span>),
                       <span class='kw'>time.predictors.prior</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1984</span>:<span class='fl'>1989</span>),
                       <span class='kw'>time.optimize.ssr</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1984</span>:<span class='fl'>1990</span>),
                       <span class='kw'>unit.names.variable</span> <span class='kw'>=</span> <span class='st'>"name"</span>,
                       <span class='kw'>time.plot</span> <span class='kw'>=</span> <span class='fl'>1984</span>:<span class='fl'>1996</span>, <span class='kw'>gen.placebos</span> <span class='kw'>=</span>  <span class='fl'>FALSE</span>,
                       <span class='kw'>Sigf.ipop</span> <span class='kw'>=</span> <span class='fl'>2</span>,
                       <span class='kw'>strategy</span> <span class='kw'>=</span> <span class='st'>'multiprocess'</span> )</div><div class='output co'>#&gt; 
#&gt; X1, X0, Z1, Z0 all come directly from dataprep object.
#&gt; 
#&gt; 
#&gt; **************** 
#&gt;  searching for synthetic control unit  
#&gt;  
#&gt; 
#&gt; **************** 
#&gt; **************** 
#&gt; **************** 
#&gt; 
#&gt; MSPE (LOSS V): 1.858825 
#&gt; 
#&gt; solution.v:
#&gt;  0.0001343847 0.4182965 5.196e-06 0.2208002 0.1681828 0.1925809 
#&gt; 
#&gt; solution.w:
#&gt;  0.0600808 0.5131245 0.004744006 0.4220507 
#&gt; 
#&gt; 
#&gt; X1, X0, Z1, Z0 all come directly from dataprep object.
#&gt; 
#&gt; 
#&gt; **************** 
#&gt;  searching for synthetic control unit  
#&gt;  
#&gt; 
#&gt; **************** 
#&gt; **************** 
#&gt; **************** 
#&gt; 
#&gt; MSPE (LOSS V): 4.717187 
#&gt; 
#&gt; solution.v:
#&gt;  0.003725274 0.01538125 0.1736298 0.00173208 0.000179908 0.8053517 
#&gt; 
#&gt; solution.w:
#&gt;  0.004277386 0.1699176 0.2240579 0.6017472 
#&gt; </div><div class='input'><span class='co'>## Plot with the average path of the treated units and the average of their</span>
<span class='co'>## respective synthetic controls:</span>

<span class='no'>multi</span>$<span class='no'>p</span></div><div class='img'><img src='multiple.synth-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bruno Castanho Silva, Michael DeWitt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


